%description:

Tests communication tracking at the service level of the network layer on an Ethernet network.

%file: test.ned

import inet.networklayer.configurator.ipv4.Ipv4NetworkConfigurator;
import inet.node.ethernet.Eth1G;
import inet.node.inet.StandardHost;
import inet.node.inet.Router;
import inet.tracker.integrated.IntegratedTracker;

network TestNetwork
{
    submodules:
        tracker: IntegratedTracker;
        configurator: Ipv4NetworkConfigurator;
        source: StandardHost;
        destination: StandardHost;
        router: Router;
    connections:
        source.ethg++ <--> Eth1G <--> router.ethg++;
        router.ethg++ <--> Eth1G <--> destination.ethg++;
}

%inifile: omnetpp.ini

[General]
network = TestNetwork
sim-time-limit = 1s
ned-path = .;../../../../src

**.arp.typename = "GlobalArp"

# ping app
*.source.numApps = 1
*.source.app[0].typename = "PingApp"
*.source.app[0].destAddr = "destination"
*.source.app[0].startTime = 0s

*.tracker.networkPathTracker.fileName = "results/network-layer.log"
*.tracker.networkPathTracker.trackPaths = true
*.tracker.networkPathTracker.activityLevel = "protocol"

%contains: results/network-layer.log
TestNetwork.source	TestNetwork.destination	ping0	network_layer protocol_level
TestNetwork.destination	TestNetwork.source	ping0-reply	network_layer protocol_level
